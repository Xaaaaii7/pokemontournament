<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pokemon Torneig - Combats</title>
<link rel="stylesheet" href="css/style.css" />
<style>
  /* Estilos específicos para la página de combates */
  :root {
    --primary: #ffcb05;
    --secondary: #3b4cca;
    --shadow: 0 4px 10px rgba(0,0,0,0.1);
  }
  body{font-family:system-ui, sans-serif;}
  .combates-container {
    max-width: 1200px;
    margin: 2rem auto;
    padding: 0 1rem;
  }
  .jornada {
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow);
    margin-bottom: 2rem;
    overflow: hidden;
  }
  .jornada-header {
    background: var(--primary);
    padding: 1rem;
    color: #212529;
    font-weight: bold;
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .jornada-header::before {
    content: "🎮";
    font-size: 1.2rem;
  }
  .combates-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    padding: 1.5rem;
  }
  .combate-card {
    border: 2px solid var(--secondary);
    border-radius: 10px;
    overflow: hidden;
    transition: transform 0.3s ease;
  }
  .combate-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
  }
  .combate-video {
    position: relative;
    padding-bottom: 56.25%; /* Relación 16:9 */
    height: 0;
    overflow: hidden;
  }
  .combate-video iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
  }
  .combate-info {
    padding: 1rem;
    background: #f8f9fa;
    cursor: pointer; /* Hace clicable el título */
  }
  .combate-info h3 {
    margin: 0 0 0.5rem 0;
    color: var(--secondary);
    font-size: 1.2rem;
  }
  .participantes {
    display: flex;
    justify-content: space-between;
    font-size: 0.9rem;
    color: #555;
    margin-bottom: 0.5rem;
  }
  .ganador {
    font-weight: bold;
    color: #d4af37;
  }
  .combate-meta {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    color: #777;
  }
  @media (max-width: 768px) {
    .combates-grid {
      grid-template-columns: 1fr;
    }
    .jornada-header {
      font-size: 1.2rem;
    }
  }
  /* Modal */
  .modal {
    display: none; /* hidden by default */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(2px);
    align-items: center;
    justify-content: center;
    z-index: 1000;
  }
  .modal-content {
    background: #fff;
    padding: 2rem;
    border-radius: 12px;
    max-width: 500px;
    width: 90%;
    box-shadow: var(--shadow);
    position: relative;
  }
  .close-btn {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 1.5rem;
    font-weight: bold;
    cursor: pointer;
    color: #777;
  }
  .close-btn:hover{color:#000;}
  #muertes-list{
    padding-left:1.2rem;
    margin:1rem 0;
    line-height:1.6;
  }
  #youtube-link{
    display:inline-block;
    background:var(--secondary);
    color:white;
    padding:0.5rem 1rem;
    border-radius:8px;
    text-decoration:none;
  }
</style>
</head>
<body>
<header style="text-align:center; padding:1rem; background:#fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
  <img src="images.jpeg" alt="Pokémon Escarlata y Púrpura" style="max-width:100%; height:auto; border-radius:12px;" />
</header>

<nav id="main-nav"></nav>

  <div class="combates-container">
    <h1 style="text-align:center; color:var(--secondary); margin-bottom:2rem;">🎥 Combats per Jornada</h1>
    <div id="jornades-container"></div>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h2>Detalls del combat</h2>
      <h3>Muertes</h3>
      <ul id="muertes-list"></ul>
      <h3>Equips</h3>
      <p id="equips-info"></p>
      <h3>Bans</h3>
      <p id="bans-info"></p>
      <a id="youtube-link" href="#" target="_blank">Ver en YouTube</a>
    </div>
  </div>

  <script>
  async function loadCombats() {
    const response = await fetch('data/jornades.json');
    const data = await response.json();
    const container = document.getElementById('jornades-container');
    data.jornades.forEach(jornada => {
      const jornadaDiv = document.createElement('div');
      jornadaDiv.className = 'jornada';
      const header = document.createElement('div');
      header.className = 'jornada-header';
      header.textContent = `Jornada ${jornada.numero}${jornada.nom ? ' - ' + jornada.nom : ''}`;
      jornadaDiv.appendChild(header);
      const grid = document.createElement('div');
      grid.className = 'combates-grid';
      jornada.combats.forEach(combat => {
        const card = document.createElement('div');
        card.className = 'combate-card';
        card.dataset.muertes = (combat.muertes || []).join('; ');
        card.dataset.equips = JSON.stringify(combat.equips || {});
        card.dataset.bans = JSON.stringify(combat.bans || {});

        const videoDiv = document.createElement('div');
        videoDiv.className = 'combate-video';
        const iframe = document.createElement('iframe');
        iframe.src = combat.youtube;
        iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
        iframe.allowFullscreen = true;
        videoDiv.appendChild(iframe);
        card.appendChild(videoDiv);
        const infoDiv = document.createElement('div');
        infoDiv.className = 'combate-info';
        const title = document.createElement('h3');
        title.textContent = `${combat.jugador1} vs ${combat.jugador2}`;
        infoDiv.appendChild(title);

        const participantes = document.createElement('div');
        participantes.className = 'participantes';
        const p1 = document.createElement('span');
        p1.textContent = combat.jugador1;
        const p2 = document.createElement('span');
        p2.textContent = combat.jugador2;
        if (combat.guanyador === combat.jugador1) {
          p1.classList.add('ganador');
          p1.textContent += ' (Guanyador)';
        }
        if (combat.guanyador === combat.jugador2) {
          p2.classList.add('ganador');
          p2.textContent += ' (Guanyador)';
        }
        participantes.appendChild(p1);
        participantes.appendChild(p2);
        infoDiv.appendChild(participantes);

        const meta = document.createElement('div');
        meta.className = 'combate-meta';
        const dateSpan = document.createElement('span');
        dateSpan.textContent = combat.data;
        const timeSpan = document.createElement('span');
        timeSpan.textContent = `⏱️ ${combat.hora}`;
        meta.appendChild(dateSpan);
        meta.appendChild(timeSpan);
        infoDiv.appendChild(meta);

        card.appendChild(infoDiv);
        grid.appendChild(card);
      });
      jornadaDiv.appendChild(grid);
      container.appendChild(jornadaDiv);
    });
    attachModalHandlers();
  }

  function attachModalHandlers() {
    const titles = document.querySelectorAll('.combate-info h3');
    const modal = document.getElementById('modal');
    const muertesList = document.getElementById('muertes-list');
    const equipsInfo = document.getElementById('equips-info');
    const bansInfo = document.getElementById('bans-info');
    const youtubeLink = document.getElementById('youtube-link');

    titles.forEach(title => {
      title.addEventListener('click', (e) => {
        const card = e.target.closest('.combate-card');
        const muertesData = (card.dataset.muertes || '').split(';');
        muertesList.innerHTML = '';
        muertesData.forEach(item => {
          const li = document.createElement('li');
          li.textContent = item.trim();
          muertesList.appendChild(li);
        });
        const equipsData = JSON.parse(card.dataset.equips || '{}');
        equipsInfo.textContent = Object.entries(equipsData)
          .map(([trainer, team]) => `${trainer}: ${team.join(', ')}`)
          .join(' | ');
        const bansData = JSON.parse(card.dataset.bans || '{}');
        const bansText = Object.entries(bansData)
          .map(([trainer, bans]) => `${trainer}: ${bans.join(', ')}`)
          .join(' | ');
        bansInfo.textContent = bansText ? `Bans: ${bansText}` : '';
        const iframe = card.querySelector('iframe');
        if (iframe) {
          const src = iframe.src;
          const normalUrl = src.replace('embed/', 'watch?v=');
          youtubeLink.href = normalUrl;
        }
        modal.style.display = 'flex';
      });
    });

    const closeBtn = document.querySelector('.close-btn');
    closeBtn.addEventListener('click', () => {
      modal.style.display = 'none';
    });
    window.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.style.display = 'none';
      }
    });
  }

  loadCombats();
  </script>
<script type="module">
    import { setupNav } from './nav-component.js';
    document.addEventListener('DOMContentLoaded', setupNav);
</script>
</body>
</html>



