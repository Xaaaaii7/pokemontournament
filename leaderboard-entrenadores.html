<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clasificaci√≥n Pok√©mon - Leaderboard</title>
<link rel="stylesheet" href="css/style.css" />
</head>
<body>
<header style="text-align:center; padding:1rem; background:#fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
  <img src="images.jpeg" alt="Pok√©mon Escarlata y P√∫rpura" style="max-width:100%; height:auto; border-radius:12px;" />
</header>
<nav>
  <ul>
    <li><a href="index.html">Inicio</a></li>
    <li><a href="reglas.html">Reglas</a></li>
    <li><a href="#">Leaderboard ‚ñº</a>
    <ul>
        <li><a href="leaderboard.html">Classificaci√≥n Pokemon</a></li>
        <li><a href="leaderboard-entrenadores.html">Classificaci√≥n Entrenadores</a></li>
      </ul>
    </li>
    <li>
      <a href="equipos.html">Equipos ‚ñº</a>
      <ul>
        <li><a href="equipos-jordi.html">Jordi</a></li>
        <li><a href="equipos-josep.html">Josep</a></li>
        <li><a href="equipos-eudald.html">Eudald</a></li>
      </ul>
    </li>
  </ul>
</nav>

<div class="leaderboard" id="leaderboard">
  <div class="loading">Cargando clasificaci√≥n...</div>
</div>

<script type="module">
  import { cargarDatos, calcularKC } from './data-loader.js';

  document.addEventListener("DOMContentLoaded", async () => {
    try {
      const data = await cargarDatos();
      const entrenadores = Object.values(data.entrenadores);
      
      // Calcular kills por combate para cada entrenador
      entrenadores.forEach(e => {
        e.killsPerBattle = calcularKC(e);
      });

      // Ordenar por kills (de mayor a menor)
      entrenadores.sort((a, b) => b.kills - a.kills);
      
      const [first, second, third, ...others] = entrenadores;
      const lb = document.getElementById('leaderboard');

      // Generar HTML
      lb.innerHTML = `
        <div class="title">üèÜ Clasificaci√≥n de Entrenadores</div>
        
        <!-- Primer puesto -->
        <div class="top-card champion">
          <img src="${first.imagen}" alt="${first.nombre}">
          <div class="stats">
            <h2>${first.nombre}</h2>
            <div class="numbers">
              <span title="Combates">‚öîÔ∏è ${first.battles}</span>
              <span title="Kills">üó°Ô∏è ${first.kills}</span>
              <span title="Muertes">‚ò†Ô∏è ${first.deaths}</span>
              <span title="Kills/Combate">‚ö° ${first.killsPerBattle}</span>
            </div>
          </div>
        </div>
        
        <!-- Segundo y tercer puesto -->
        <div class="podium">
          ${[second, third].map(p => `
            <div class="podium-card">
              <img src="${p.imagen}" alt="${p.nombre}">
              <div class="stats">
                <h3>${p.nombre}</h3>
                <div class="numbers">
                  <span>‚öîÔ∏è ${p.battles}</span>
                  <span>üó°Ô∏è ${p.kills}</span>
                  <span>‚ò†Ô∏è ${p.deaths}</span>
                  <span>‚ö° ${p.killsPerBattle}</span>
                </div>
              </div>
            </div>`).join('')}
        </div>
        
        <!-- Dem√°s participantes (lista compacta) -->
        <ul class="compact-list">
          ${others.map((p, index) => `
            <li>
              <span class="pos">${index + 4}¬∫</span>
              <img src="${p.imagen}" alt="${p.nombre}" title="${p.nombre}">
              <span class="icons">
                <span title="Kills">üó°Ô∏è${p.kills}</span>
                <span title="Muertes">‚ò†Ô∏è${p.deaths}</span>
                <span title="Combates">‚öîÔ∏è${p.battles}</span>
                <span title="Kills/Combate">‚ö°${p.killsPerBattle}</span>
              </span>
            </li>`).join('')}
        </ul>`;
    } catch (error) {
      console.error('Error:', error);
      document.getElementById('leaderboard').innerHTML = `
        <div class="error">
          <p>‚ö†Ô∏è No se pudo cargar la clasificaci√≥n</p>
          <p>${error.message}</p>
        </div>`;
    }
  });
</script>
</body>
</html>
